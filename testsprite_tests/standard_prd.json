{
  "meta": {
    "project": "Telegram Bingo Game Platform",
    "date": "2025-11-14",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "Telegram Bingo Game Platform is a web-based real-time multiplayer bingo game integrating Telegram authentication. Players can join game lobbies, participate in live games with synchronized game state via sockets, manage wallets for deposits and withdrawals, and compete on leaderboards. Admins can configure games and monitor platform activity via a dedicated portal.",
  "core_goals": [
    "Provide seamless user authentication through Telegram Web App.",
    "Enable real-time multiplayer bingo gameplay with synchronized game state across participants.",
    "Facilitate easy game joining and lobby browsing with balance and eligibility checks.",
    "Manage user wallets with secure deposit and withdrawal transactions.",
    "Display global leaderboards to encourage competition among players.",
    "Offer a waiting room for players prior to game start with countdown and notifications.",
    "Provide an admin portal for game configuration, monitoring, and management.",
    "Ensure robust validation of game actions like bingo claims with fairness and security."
  ],
  "key_features": [
    "Telegram Authentication with auto-login support and user profile capture.",
    "Game Lobby displaying available games with join functionality.",
    "Game Room featuring real-time bingo gameplay with socket.io for synchronization and bingo claim handling.",
    "Waiting Room offering countdown timers and player status before games start.",
    "User Wallet management with APIs for balance query, deposits, and withdrawals.",
    "Leaderboard displaying top players based on game performance and earnings.",
    "Admin Portal for administrative control including game configurations and monitoring.",
    "Robust API endpoints to support frontend-backend interactions and state management.",
    "Real-time communication using WebSockets for game updates and player actions.",
    "Sound effects and interactive UI elements to enhance player experience."
  ],
  "user_flow_summary": [
    "User authenticates via Telegram Web App; upon success, redirected to the Game Lobby.",
    "In the Game Lobby, user views available games along with game details and chooses a game to join.",
    "If eligible and balance sufficient, user joins the game room or is queued if game is active.",
    "In the Game Room, the user plays bingo with real-time updates, can mark numbers, and claim bingo wins.",
    "Claims are validated on the backend before winners are announced and prizes distributed.",
    "Users can access the Waiting Room to see countdown timer before game start and chat with other players.",
    "User can manage wallet from dedicated wallet page: view balance, deposit funds, and withdraw earnings.",
    "Leaderboard page shows top player rankings, updated in real-time or periodically.",
    "Admins access the Admin Portal to configure games and monitor ongoing matches and user activities."
  ],
  "validation_criteria": [
    "Successful user authentication via Telegram with correct user data retrieval and session management.",
    "Game join API correctly validates user eligibility, game state, and balance before admitting players.",
    "Real-time game state synchronization during gameplay with no lag or missed updates.",
    "Correct validation of bingo claims covering all win patterns and rejection of invalid claims.",
    "Handling of concurrent bingo claims with atomic winner resolution to avoid multiple winners.",
    "Accurate wallet balance updates reflecting deposits, withdrawals, and game earnings.",
    "Leaderboard data reflects the current top players with proper sorting and timely updates.",
    "Admin portal displays current and accurate configurations and server-side game data.",
    "Socket events correctly broadcast player actions and game state changes to all relevant clients.",
    "Proper error handling and user feedback provided for all user interactions including login, game join, gameplay, and wallet operations."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js 14",
      "React 18",
      "Supabase",
      "Socket.io",
      "TailwindCSS",
      "Telegraf (Telegram Bot)",
      "Express"
    ],
    "features": [
      {
        "name": "Telegram Authentication",
        "description": "User authentication via Telegram Web App with auto-login for development",
        "files": [
          "app/login/page.tsx",
          "lib/hooks/useAuth.ts",
          "lib/auth.ts"
        ],
        "api_doc": {
          "endpoint": "/api/auth/telegram",
          "method": "POST",
          "description": "Authenticate user with Telegram credentials",
          "requestBody": {
            "type": "object",
            "properties": {
              "id": {
                "type": "number"
              },
              "username": {
                "type": "string"
              },
              "first_name": {
                "type": "string"
              },
              "last_name": {
                "type": "string"
              }
            }
          }
        }
      },
      {
        "name": "Game Lobby",
        "description": "Main lobby page where users can see available games and join",
        "files": [
          "app/lobby/page.tsx",
          "app/api/games/list/route.ts",
          "app/api/game/join/route.ts"
        ],
        "api_doc": {
          "endpoints": [
            {
              "path": "/api/games/list",
              "method": "GET",
              "description": "Get list of available games"
            },
            {
              "path": "/api/game/join",
              "method": "POST",
              "description": "Join a game room"
            }
          ]
        }
      },
      {
        "name": "Game Room",
        "description": "Real-time bingo game with socket.io synchronization",
        "files": [
          "app/game/[roomId]/page.tsx",
          "lib/hooks/useSocket.ts",
          "app/api/game/claim-bingo/route.ts"
        ],
        "api_doc": {
          "endpoints": [
            {
              "path": "/api/game/claim-bingo",
              "method": "POST",
              "description": "Claim bingo win and validate"
            }
          ],
          "socketEvents": [
            "join_game",
            "leave_game",
            "mark_number",
            "claim_bingo",
            "game_state_update",
            "number_drawn"
          ]
        }
      },
      {
        "name": "Waiting Room",
        "description": "Waiting room for games to start with countdown timer",
        "files": [
          "server/waiting-room-app.ts",
          "app/api/game/waiting-room/route.ts"
        ],
        "api_doc": {
          "socketEvents": [
            "join_waiting_room",
            "leave_waiting_room",
            "waiting_room_update",
            "game_start_countdown"
          ]
        }
      },
      {
        "name": "Wallet & Transactions",
        "description": "User wallet management with deposit and withdrawal",
        "files": [
          "app/wallet/page.tsx",
          "app/api/wallet/balance/route.ts",
          "app/api/wallet/deposit/route.ts",
          "app/api/wallet/withdraw/route.ts"
        ],
        "api_doc": {
          "endpoints": [
            {
              "path": "/api/wallet/balance",
              "method": "GET",
              "description": "Get user wallet balance"
            },
            {
              "path": "/api/wallet/deposit",
              "method": "POST",
              "description": "Deposit funds to wallet"
            },
            {
              "path": "/api/wallet/withdraw",
              "method": "POST",
              "description": "Withdraw funds from wallet"
            }
          ]
        }
      },
      {
        "name": "Leaderboard",
        "description": "Global leaderboard showing top players",
        "files": [
          "app/leaderboard/page.tsx",
          "app/api/leaderboard/route.ts"
        ],
        "api_doc": {
          "endpoints": [
            {
              "path": "/api/leaderboard",
              "method": "GET",
              "description": "Get leaderboard rankings"
            }
          ]
        }
      },
      {
        "name": "Admin Portal",
        "description": "Admin management portal for game configuration and monitoring",
        "files": [
          "app/mgmt-portal-x7k9p2/page.tsx",
          "app/api/admin/config/route.ts",
          "app/api/admin/games/route.ts"
        ],
        "api_doc": {
          "endpoints": [
            {
              "path": "/api/admin/config",
              "method": "GET",
              "description": "Get admin configuration"
            },
            {
              "path": "/api/admin/games",
              "method": "GET",
              "description": "Get all games for admin"
            }
          ]
        }
      }
    ]
  }
}
